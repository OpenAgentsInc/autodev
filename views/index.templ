package views

import "strconv"

templ Index(cssVersion string, data map[string]interface{}) {
	<html>
		<head>
			<title>AutoDev - GitHubFS</title>
			<link href={ "/static/css/output.css?" + cssVersion } rel="stylesheet"/>
		</head>
		<body class="bg-black text-white font-mono h-screen w-screen flex items-center justify-center">
			<div class="border border-white p-6 rounded-lg max-w-2xl w-full">
				if repo, ok := data["Repo"].(string); ok && repo != "" {
					<h1 class="text-2xl mb-2">{ repo }</h1>
					if branches, ok := data["Branches"].([]string); ok {
						<p class="text-lg mb-4">Number of branches: { strconv.Itoa(len(branches)) }</p>
						if branchFileCounts, ok := data["BranchFileCounts"].(map[string]int); ok {
							<table class="w-full">
								<thead>
									<tr>
										<th class="text-left">Branch</th>
										<th class="text-right">Files</th>
									</tr>
								</thead>
								<tbody>
									for _, branch := range branches {
										<tr>
											<td class="text-left">{ branch }</td>
											<td class="text-right">{ strconv.Itoa(branchFileCounts[branch]) }</td>
										</tr>
									}
								</tbody>
							</table>
						}
					}
				} else {
					<p class="text-xl">No repository specified. Use ?repo=owner/name in the URL.</p>
				}
			</div>
		</body>
	</html>
}

func joinStrings(strs []string, sep string) string {
	if len(strs) == 0 {
		return ""
	}
	result := strs[0]
	for _, s := range strs[1:] {
		result += sep + s
	}
	return result
}
