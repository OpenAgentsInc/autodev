package views

import "github.com/openagentsinc/autodev/agent"

templ Index(cssVersion string, myAgent *agent.Agent) {
	<html>
		<head>
			<title>AutoDev Workspace</title>
			<link href={ "/static/css/output.css?" + cssVersion } rel="stylesheet"/>
			<script src="https://unpkg.com/htmx.org@2.0.0" integrity="sha384-wS5l5IKJBvK6sPTKa2WZ1js3d947pvWXbPJ1OmWfEuxLgeHcEbjUUA5i9V5ZkpCw" crossorigin="anonymous"></script>
			<script src="https://unpkg.com/htmx-ext-sse@2.0.0/sse.js"></script>
		</head>
		<body class="bg-black text-white font-mono h-screen flex">
			<!-- Left Sidebar -->
			<div class="w-64 bg-black p-4 flex flex-col border-r border-zinc-800">
				<div class="flex items-center mb-8">
					<span class="text-2xl font-bold">üöÄ AutoDev</span>
				</div>
				<div class="flex-grow"></div>
				<div class="space-y-2">
					<button class="w-full text-left py-2 px-4 rounded hover:bg-zinc-900">About us</button>
					<button class="w-full text-left py-2 px-4 rounded hover:bg-zinc-900">Request access</button>
					<button class="w-full text-left py-2 px-4 rounded hover:bg-zinc-900">Login</button>
				</div>
			</div>
			<!-- Main Content Area -->
			<div class="flex-grow flex">
				<!-- Message List -->
				<div class="w-1/2 flex flex-col bg-black border-r border-zinc-800">
					<div id="message-list" class="flex-grow p-4 overflow-y-auto">
						<div class="bg-zinc-900 rounded p-3 mb-4 inline-block">
							AutoDev awaiting instructions.
						</div>
						<!-- New messages will be added here -->
					</div>
					<form id="message-form" class="p-4 border-t border-zinc-800" hx-post="/submit-message" hx-target="#message-list" hx-swap="beforeend">
						<input type="text" name="message" placeholder="Type your message..." class="w-full bg-zinc-900 text-white rounded p-2"/>
					</form>
				</div>
				<!-- Right Sidebar -->
				<div class="w-1/2 bg-black p-4 flex flex-col">
					<div class="flex justify-between items-center mb-4">
						<h2 class="text-xl font-bold">AutoDev's Workspace</h2>
						<div class="flex items-center space-x-2">
							<span>Following</span>
							<div class="w-12 h-6 bg-zinc-800 rounded-full p-1 cursor-pointer">
								<div class="w-4 h-4 bg-blue-500 rounded-full"></div>
							</div>
						</div>
					</div>
					<div class="flex space-x-4 mb-4">
						<button class="px-3 py-1 rounded hover:bg-zinc-900">Shell</button>
						<button class="px-3 py-1 rounded hover:bg-zinc-900">Browser</button>
						<button class="px-3 py-1 rounded hover:bg-zinc-900">Editor</button>
						<button class="px-3 py-1 bg-zinc-800 rounded font-bold">Planner</button>
					</div>
					<div class="flex-grow bg-zinc-900 rounded p-4 mb-4 overflow-y-auto">
						<h3 class="text-lg font-bold mb-2">Main Goal:</h3>
						<p class="mb-4">{ myAgent.GetPlan().MainGoal }</p>
						<h3 class="text-lg font-bold mb-2">Tasks:</h3>
						<div class="h-full overflow-y-auto">
							<ul
								id="task-list"
								hx-ext="sse"
								sse-connect="/plan-updates"
								sse-swap="message"
								class="list-none pl-0 space-y-2"
							></ul>
						</div>
					</div>
					<div class="flex justify-between">
						<button
							hx-post="/replay"
							hx-trigger="click"
							hx-target="#task-list"
							hx-swap="innerHTML"
							class="px-3 py-1 rounded hover:bg-zinc-900"
						>‚èÆ Replay</button>
						<button class="px-3 py-1 rounded hover:bg-zinc-900">‚è≠</button>
					</div>
				</div>
			</div>
			<script>
				// ... (previous JavaScript code remains unchanged)
			</script>
		</body>
	</html>
}
